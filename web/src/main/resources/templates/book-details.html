<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title th:text="${book.title}">Details</title>
    <style>body { font-family: sans-serif; padding: 20px; }</style>
</head>
<body>

<div th:replace="~{fragments/header :: header}"></div>

<h1 th:text="${book.title}">Title</h1>
<p>
    <span th:text="#{table.author} + ':'">Author:</span>
    <strong th:text="${book.author}"></strong>
    (<span th:text="#{label.year}">Year</span>: <span th:text="${book.year}"></span>)
</p>

<hr/>

<h3 th:text="#{label.comments}">Reviews:</h3>
<ul>
    <li th:each="c : ${comments}" style="margin-bottom: 10px;">
        <strong th:text="${c.author}">User</strong>:
        <span th:text="${c.text}">Text</span>
        <span style="color:gray; font-size:0.8em;" th:text="${#temporals.format(c.createdAt, 'dd.MM.yyyy HH:mm')}"></span>

        <form th:action="@{/comments/delete}" method="post" style="display:inline; margin-left: 10px;">
            <input type="hidden" name="bookId" th:value="${book.id}"/>
            <input type="hidden" name="commentId" th:value="${c.id}"/>
            <input type="hidden" name="createdAt" th:value="${c.createdAt} + 'Z'"/>

            <button type="submit" style="color: red; font-size: 0.8em; cursor: pointer; border: 1px solid red; background: none;">
                ‚ùå <span th:text="#{btn.delete}">Delete</span>
            </button>
        </form>
    </li>
</ul>

<hr/>

<h3 th:text="#{label.leave_comment}">Leave a review:</h3>
<form th:action="@{/books/{id}/comments(id=${book.id})}" method="post" style="background: #f9f9f9; padding: 15px; border-radius: 5px; border: 1px solid #ddd;">

    <div style="margin-bottom: 10px;">
        <label for="text" th:text="#{label.comment_text} + ':'">Review:</label><br>
        <textarea id="text" name="text" rows="3" cols="50" required
                  th:placeholder="#{label.placeholder_text}" style="padding: 5px;"></textarea>
    </div>

    <button type="submit" style="padding: 8px 15px; background: #28a745; color: white; border: none; cursor: pointer;"
            th:text="#{btn.send}">Send</button>
</form>

</body>
</html>